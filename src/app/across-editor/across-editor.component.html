<form [formGroup]="componentForm">
  <div class="new-rating">
    <div class="row">
      <div class="col-6">
        <label class="label"> No of Rows </label>
        <div class="form-group input-type p-field">
          <input
            formControlName="row"
            placeholder="No of rows"
            class="input-field"
            (change)="getRowCount()"
            pInputText
            maxlength="51"
          />
        </div>
      </div>
      <div class="col-6">
        <label class="label"> No of Columns </label>
        <div class="form-group input-type p-field">
          <input
            formControlName="column"
            placeholder="No of columns"
            class="input-field"
            (change)="getColumnCount()"
            pInputText
            maxlength="51"
          />
        </div>
      </div>
    </div>
    <div class="col-12">
      <div class="form-group">
        <p *ngIf="merge" class="col-12">Select Columns to be merged</p>
        <div class="rating-editor tableEditer-box">
          <table>
            <ng-container formArrayName="rows">
              <tr
                *ngFor="
                  let rowControl of tableRowControls['controls'];
                  let i = index
                "
                formGroupName="{{ i }}"
              >
                <ng-container formArrayName="columns">
                  <td
                    *ngFor="
                      let columnControl of rowControl.get('columns')[
                        'controls'
                      ];
                      let j = index
                    "
                    [ngClass]="
                      columnControl.value.checked ? 'selectedCell' : ''
                    "
                    [ngStyle]="{
                      color: columnControl.value.textColor,
                      'background-color': columnControl.value.bgColor,
                      'font-size': columnControl.value.fontSize
                    }"
                    [attr.colspan]="columnControl.value.colspan"
                    [attr.rowspan]="columnControl.value.rowspan"
                    formGroupName="{{ j }}"
                    (dblclick)="op.toggle($event)"
                    (click)="getCellDetail(columnControl,i)"
                  >
                    {{ labelType[columnControl.value.colType] }}
                    <ng-container
                      *ngIf="columnControl.value.colType == 'label'"
                    >
                      <input
                        formControlName="value"
                        placeholder="Enter label title"
                        class="input-field"
                        pInputText
                        maxlength="51"
                      />
                    </ng-container>
                    <ng-container
                      *ngIf="columnControl.value.colType == 'dropDown'"
                    >
                      <p-dropdown
                        formControlName="value"
                        [options]="products"
                        placeholder="Select dropdown type"
                        optionLabel="name"
                        optionValue="value"
                      ></p-dropdown>
                    </ng-container>
                    <ng-container
                      *ngIf="columnControl.value.colType == 'input'"
                    >
                      <input
                        formControlName="value"
                        placeholder="Enter Input"
                        class="input-field"
                        pInputText
                        maxlength="51"
                      />
                    </ng-container>
                    <p-overlayPanel #op>
                      <div class="grid p-2">
                        <div class="col-12">
                          <label class="label">Component Type</label>
                          <p-dropdown
                            formControlName="colType"
                            placeholder="Select column type"
                            [options]="products"
                            optionLabel="name"
                            optionValue="value"
                          ></p-dropdown>
                          <label for="txtColor" class="label">Text Color</label>
                          <p-colorPicker
                            id="txtColor"
                            formControlName="textColor"
                          ></p-colorPicker>
                          <label for="bgColor" class="label"
                            >Background Color</label
                          >
                          <p-colorPicker
                            id="bgColor"
                            formControlName="bgColor"
                          ></p-colorPicker>
                          <label for="bgColor" class="label">Font Size</label>
                          <p-dropdown
                            formControlName="fontSize"
                            [options]="fontSize"
                            placeholder="Select font size"
                            optionLabel="name"
                            optionValue="value"
                          ></p-dropdown>
                        </div>
                      </div>
                    </p-overlayPanel>
                  </td>
                </ng-container>
                <td>
                  <button
                    class="linkBtn-submit"
                    (dblclick)="opRow.toggle($event)"
                  >
                    row
                  </button>
                </td>
                <p-overlayPanel #opRow>
                  <div class="grid p-2">
                    <div class="col-12">
                      <label class="label">Component Type</label>
                      <p-dropdown
                        placeholder="Select column type"
                        [options]="products"
                        optionLabel="name"
                        optionValue="value"
                        (onChange)="getRowProperty($event, i, 'colType')"
                      ></p-dropdown>
                      <label for="txtColor" class="label">Text Color</label>
                      <p-colorPicker
                        id="txtColor"
                        (onChange)="getRowProperty($event, i, 'textColor')"
                      ></p-colorPicker>
                      <label for="bgColor" class="label"
                        >Background Color</label
                      >
                      <p-colorPicker
                        id="bgColor"
                        (onChange)="getRowProperty($event, i, 'bgColor')"
                      ></p-colorPicker>
                      <label for="bgColor" class="label">Font Size</label>
                      <p-dropdown
                        [options]="fontSize"
                        placeholder="Select font size"
                        (onChange)="getRowProperty($event, i, 'fontSize')"
                        optionLabel="name"
                        optionValue="value"
                      ></p-dropdown>
                    </div>
                  </div>
                </p-overlayPanel>
              </tr>
            </ng-container>
          </table>
        </div>
      </div>
    </div>
    <div class="col-12">
      <button
      *ngIf="getMergeColumnButtonStatus()"
        style="float: right;"
        class="linkBtn-submit ml-3"
        (click)="mergeData()"
      >
        Merge Columns
      </button>
      <button
        style="float: right;"
        *ngIf="isAdd"
        class="linkBtn-submit"
        (click)="addMoreRows()"
      >
        Add Row
      </button>
    </div>
  </div>
  <div class="col-12 btn-curev">
    <div class="input-button">
      <button type="button" class="linkBtn-submit" (click)="postData()">
        Save
      </button>
    </div>
  </div>
</form>
